<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>LED Control</title>
<style>
button { font-size: 30px; padding: 10px 20px; margin: 10px; }
.active { background-color: lime; }
#status { font-size: 24px; margin-top: 20px; }
</style>
</head>
<body style="text-align:center">

<h2>LED Control</h2>

<button id="btnOn" onclick="sendCmd('on')">ON</button>
<button id="btnOff" onclick="sendCmd('off')">OFF</button>
<button id="btnBlink" onclick="sendCmd('blink')">BLINK</button>
<br>
<button id="btnVoice" onclick="startVoice()">ðŸŽ¤ Voice</button>

<div id="status">Say "on", "off", or "blink"</div>

<script>
let recognition;
if ('webkitSpeechRecognition' in window) {
    recognition = new webkitSpeechRecognition();
    recognition.continuous = false;
    recognition.interimResults = false;
    recognition.lang = 'en-US';

    recognition.onresult = function(event) {
        let text = event.results[0][0].transcript.toLowerCase();
        document.getElementById('status').innerText = "Heard: " + text;

        if (text.includes('on')) {
            sendCmd('on');
            highlightButton('btnOn');
        } else if (text.includes('off')) {
            sendCmd('off');
            highlightButton('btnOff');
        } else if (text.includes('blink')) {
            sendCmd('blink');
            highlightButton('btnBlink');
        }

        recognition.stop();
    }

    recognition.onend = function() {
        // recognition.start(); // ÐµÑÐ»Ð¸ Ñ…Ð¾Ñ‡ÐµÑˆÑŒ Ð½ÐµÐ¿Ñ€ÐµÑ€Ñ‹Ð²Ð½Ð¾Ðµ Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð²Ð°Ð½Ð¸Ðµ
    }
} else {
    alert("Your browser does not support Speech Recognition.");
}

function sendCmd(cmd) {
    fetch("/" + cmd);
}

function startVoice() {
    document.getElementById('status').innerText = "Listening...";
    recognition.start();
}

function highlightButton(id) {
    document.querySelectorAll('button').forEach(b => b.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    setTimeout(() => document.getElementById(id).classList.remove('active'), 1000);
}
</script>

</body>
</html>
